(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{213:function(t,e,a){"use strict";a.r(e);var s=a(0),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"contract-hosts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contract-hosts","aria-hidden":"true"}},[t._v("#")]),t._v(" Contract Hosts")]),t._v(" "),a("p",[t._v("ContractHost provides a way to install and run verifiable contracts.")]),t._v(" "),a("p",[t._v('Install(source) creates Installations. Installations represent particular\ncontract forms, which can be spawn()\'d to create Contract instances\ninitialized with specific terms. These Contracts manage invitations for\nmultiple seats, each of which repesents a "role" in an interaction.')]),t._v(" "),a("p",[t._v("Some seats provide the methods "),a("code",[t._v("getWinnings()")]),t._v(" and "),a("code",[t._v("getRefunds()")]),t._v(", which return\npromises for payments for the outputs of the interaction. We provide the\n"),a("code",[t._v("collect()")]),t._v(" method (described later) to simplify collection of winnings and\nrefunds into appropriate purses.")]),t._v(" "),a("h2",{attrs:{id:"contracthost"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contracthost","aria-hidden":"true"}},[t._v("#")]),t._v(" ContractHost")]),t._v(" "),a("h3",{attrs:{id:"contracthost-install-contractsrc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contracthost-install-contractsrc","aria-hidden":"true"}},[t._v("#")]),t._v(" contractHost.install(contractSrc)")]),t._v(" "),a("p",[t._v("ContractSrc is the source code for a Contract. See Contract for details.")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("contractSrc")]),t._v(" "),a("code",[t._v("{String}")])]),t._v(" "),a("li",[a("strong",[t._v("Returns:")]),t._v(" "),a("code",[t._v("{Installation}")])]),t._v(" "),a("li",[a("strong",[t._v("Usage:")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Examples\n")])])]),a("h3",{attrs:{id:"contracthost-getinstallationsourcecode-installation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contracthost-getinstallationsourcecode-installation","aria-hidden":"true"}},[t._v("#")]),t._v(" contractHost.getInstallationSourceCode(installation)")]),t._v(" "),a("p",[t._v("Returns the actual source of the Installation.")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("installation")]),t._v(" "),a("code",[t._v("{Installation}")])]),t._v(" "),a("li",[a("strong",[t._v("Returns:")]),t._v(" "),a("code",[t._v("{String}")])]),t._v(" "),a("li",[a("strong",[t._v("Usage:")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Examples\n")])])]),a("h3",{attrs:{id:"contracthost-redeem-invite"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contracthost-redeem-invite","aria-hidden":"true"}},[t._v("#")]),t._v(" contractHost.redeem(invite)")]),t._v(" "),a("p",[t._v("Seat invitations are packaged as payments from the Invite Assay. Redeeming an invite returns a seat object with an arbitrary interface (the interface is at the discretion of the contract) which supports interaction according to the terms.")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("invite")]),t._v(" "),a("code",[t._v("{Payment}")])]),t._v(" "),a("li",[a("strong",[t._v("Returns:")]),t._v(" "),a("code",[t._v("{Object}")])]),t._v(" "),a("li",[a("strong",[t._v("Usage:")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Examples\n")])])]),a("h3",{attrs:{id:"contracthost-getinviteassay"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contracthost-getinviteassay","aria-hidden":"true"}},[t._v("#")]),t._v(" contractHost.getInviteAssay()")]),t._v(" "),a("p",[t._v("The assay allows holders of seat invitations to get exclusive access to a Seat.")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("Returns:")]),t._v(" "),a("code",[t._v("{Assay}")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("Usage:")])])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Examples\n")])])]),a("h2",{attrs:{id:"installation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installation","aria-hidden":"true"}},[t._v("#")]),t._v(" Installation")]),t._v(" "),a("p",[t._v("An installation of a Contract can spawn multiple copies each with the same or different terms. Each spawned instance has distinct invites and distinct seats representing a specific group of agents interacting according to the same prescribed roles.")]),t._v(" "),a("p",[t._v("The Installation can also have functions with names starting "),a("code",[t._v("check")]),t._v(", as defined by the contract. They can be used to validate that the expected terms are actually the same as the terms of this spawned contract. The Installation is inserted by the ContactHost as the first parameter to these functions. The naming restriction is likely to be lifted.")]),t._v(" "),a("h3",{attrs:{id:"installation-spawn-terms"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installation-spawn-terms","aria-hidden":"true"}},[t._v("#")]),t._v(" installation.spawn(terms)")]),t._v(" "),a("p",[t._v("Create a new InviteMaker, then call the Contract's start() method and return its results. The results are often a collection of seat invitations for the seats in the contract, but see coveredCall for an exception.")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("terms")]),t._v(" "),a("code",[t._v("{Terms}")])]),t._v(" "),a("li",[a("strong",[t._v("Returns:")]),t._v(" "),a("code",[t._v("{invites <Object>}")])]),t._v(" "),a("li",[a("strong",[t._v("Usage:")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Examples\n")])])]),a("h3",{attrs:{id:"installation-checkassetdesc-installation-inviteassetdesc-terms"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installation-checkassetdesc-installation-inviteassetdesc-terms","aria-hidden":"true"}},[t._v("#")]),t._v(" installation.checkAssetDesc(installation, inviteAssetDesc, terms)")]),t._v(" "),a("p",[t._v("The writer of the contract can provide methods to help users of the contract verify that the terms of the contract match their expectation. These methods are defined with the installation as the first parameter, so the verifiers can validate that the caller's invitation was issued by the same one. The invocation by clients should omit this parameter, as they will be supplied with a copy of the function with that information already supplied.")]),t._v(" "),a("p",[t._v("Users usually want to validate their invitation, the terms of the deal they're attempting to participate in, and which seat they are taking.")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("installation")]),t._v(" "),a("code",[t._v("{Installation}")])]),t._v(" "),a("li",[a("code",[t._v("inviteAssetDesc")]),t._v(" "),a("code",[t._v("{AssetDesc}")])]),t._v(" "),a("li",[a("code",[t._v("terms")]),t._v(" "),a("code",[t._v("{Terms}")])])]),t._v(" "),a("h1",{attrs:{id:"no-return-listed-for-this-method"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#no-return-listed-for-this-method","aria-hidden":"true"}},[t._v("#")]),t._v(" No return listed for this method")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Returns:")])]),t._v(" "),a("li",[a("strong",[t._v("Usage:")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Examples\n")])])]),a("h2",{attrs:{id:"contract"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contract","aria-hidden":"true"}},[t._v("#")]),t._v(" Contract")]),t._v(" "),a("p",[t._v("Contracts are pass-by-text.")]),t._v(" "),a("p",[t._v("The ContractHost's install() method is called on the source code for a contract. The contract needs to have a start() method with arguments as described below. Creating the contract object by calling evaluate() on the source code enables the ContractHost to guarantee to its clients that the resulting object implements that specific algorithm, and doesn't have any hidden powers.")]),t._v(" "),a("p",[t._v("The form of the 'terms' argument to the contract's start() method is also completely up to the individual contract. It should represent all the information a participant needs in order to know they're participating in the contract they intended. As an example, the 'escrow' contract represents a simple exchange of one bundle of goods for another. Escrow's terms object has the 'assetDesc's to be traded as 'left' and 'right', which correspond to the assetDescs being offered and collected by the respective parties. The Object returned by escrow is an array containing two invitations, but this isn't required. The representation is flexible enough to support trading of money, non-fungible items, or partially-executed positions in other contracts among other possibilities. Other contracts take different paths.")]),t._v(" "),a("p",[t._v("Javascript gives access to the source from a function, but not from an object. We make the source accessible to the ContractHost by having contracts export a record containing the source. The contract can also define methods that can be called by participants in the contract to validate that the terms they expect the contract to have been installed with are in agreement with the contract.")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" escrowExchangeSrcs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("escrowExchange"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("start"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  checkAssetDesc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("escrowExchange"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("checkAssetDesc"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"contract-start-terms-invitemaker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contract-start-terms-invitemaker","aria-hidden":"true"}},[t._v("#")]),t._v(" contract.start(terms, inviteMaker)")]),t._v(" "),a("p",[t._v("Start execution of the contract. May return invites for seats.")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("terms")]),t._v(" "),a("code",[t._v("{Terms}")])]),t._v(" "),a("li",[a("code",[t._v("inviteMaker")]),t._v(" "),a("code",[t._v("{InviteMaker}")])]),t._v(" "),a("li",[a("strong",[t._v("Returns:")]),t._v(" "),a("code",[t._v("{Object}")])]),t._v(" "),a("li",[a("strong",[t._v("Usage:")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Examples\n")])])]),a("h2",{attrs:{id:"invitemaker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#invitemaker","aria-hidden":"true"}},[t._v("#")]),t._v(" InviteMaker")]),t._v(" "),a("p",[t._v("An InviteMaker is provided to contracts as a parameter to "),a("code",[t._v("start()")]),t._v(". It allows the contract to issue invitations for seats, arbitrary objects whose interface defines the roles and interactions in the contract. The design of the InviteMaker allows recipients of invites to validate that the invite corresponds to the seat and contract that they expected.\n'seatDesc' can be any truthy object, but Strings are convenient. They must be unique for each contract instantiation. 'seat' is an arbitrary object defined by the contract. 'name' is optional; it is used to label the invite payment corresponding to the seat.")]),t._v(" "),a("h3",{attrs:{id:"invitemaker-make-seatdesc-name"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#invitemaker-make-seatdesc-name","aria-hidden":"true"}},[t._v("#")]),t._v(" inviteMaker.make(seatDesc, name)")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("seatDesc")]),t._v(" "),a("code",[t._v("{String}")])]),t._v(" "),a("li",[a("code",[t._v("seat")]),t._v(" "),a("code",[t._v("{Objet}")])]),t._v(" "),a("li",[a("code",[t._v("name")]),t._v(" "),a("code",[t._v("{String}")]),t._v(" - The name of an invite payment")]),t._v(" "),a("li",[a("strong",[t._v("Returns:")]),t._v(" "),a("code",[t._v("{Purse}")])]),t._v(" "),a("li",[a("strong",[t._v("Usage:")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Examples\n")])])]),a("h2",{attrs:{id:"collector"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#collector","aria-hidden":"true"}},[t._v("#")]),t._v(" Collector")]),t._v(" "),a("p",[t._v("collect() calls getWinnings() and 'getRefund()' on seatP and deposits the proceeds respectively into winPurseP and refundPurseP. 'name' (which defaults to 'collecting') is converted to a String, and used for logging the results.")]),t._v(" "),a("p",[t._v("'collect()' is a pure function that can be imported from 'contractHost.js'. (Jessie will eventually provide assurances, because of the way that we import modules, that it is confined.)  Since it is confined, users can be sure that it has no ability to skim any of the value being transferred.")]),t._v(" "),a("p",[t._v("collect() violates our usual rule of only transferring payments, and never sharing purses. This rule helps us ensure that users don't share a purse when they only intended to share a portion of the contents. We allow collect() to violate the rule because it's such a common pattern.")]),t._v(" "),a("p",[t._v("This function is a convenient wrapper that makes it easier to work with our Escrow contract, and has no privileged access.")]),t._v(" "),a("h3",{attrs:{id:"collector-collect-seatp-winpursep-refundpursep-name"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#collector-collect-seatp-winpursep-refundpursep-name","aria-hidden":"true"}},[t._v("#")]),t._v(" collector.collect(seatP, winPurseP, refundPurseP, name)")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("seatP")]),t._v(" "),a("code",[t._v("{Object}")])]),t._v(" "),a("li",[a("code",[t._v("winPurseP")]),t._v(" "),a("code",[t._v("{Purse}")])]),t._v(" "),a("li",[a("code",[t._v("refundPurseP")]),t._v(" "),a("code",[t._v("{Purse}")])]),t._v(" "),a("li",[a("code",[t._v("name")]),t._v(" "),a("code",[t._v("{String}")])]),t._v(" "),a("li",[a("strong",[t._v("Returns:")]),t._v(" "),a("code",[t._v("{winsAndRefunds <Object>}")])]),t._v(" "),a("li",[a("strong",[t._v("Usage:")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Examples\n")])])]),a("h2",{attrs:{id:"terms"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#terms","aria-hidden":"true"}},[t._v("#")]),t._v(" Terms")]),t._v(" "),a("p",[t._v("Arbitrary terms defined by each contract.")]),t._v(" "),a("p",[t._v("These are defined by the contract, passed to spawn(), and available to be validated in the check methods (or manually by contract participants to ensure they are connected to a contract with matching expectations about what will be traded, and which seat they will occupy.")])])}),[],!1,null,null,null);e.default=n.exports}}]);